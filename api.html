<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Web Call Oxnya</title>
</head>
<body>

  <h2>Lancer un appel via API SIP (Oxnya Group)</h2>

  <form id="callForm">
    <label for="phone">Numéro à appeler :</label>
    <input type="text" id="phone" name="phone" placeholder="+33612345678" required>
    <button type="submit">Appeler</button>
  </form>

  <p>URL de l'appel générée : <span id="phone-link"></span></p>

  <script>
    document.getElementById("callForm").addEventListener("submit", function(e) {
      e.preventDefault();
      var phoneNumber = document.getElementById("phone").value;
      var anumber = "oxnya_group"; // ton SIP Zoiper ou autre softphone
      var bnumber = phoneNumber;
      var callLink = "https://api.ippi.com/sip-activity/start-call?login=oxnya_group&apiPassword=cc24NOLHAN*&anumber=" + anumber + "&bnumber=" + bnumber;
      document.getElementById("phone-link").textContent = callLink;

      fetch(callLink)
        .then(response => response.json())
        .then(data => {
          if (data.code === "OK") {
            alert("Appel lancé avec succès !");
          } else {
            alert("Erreur : " + data.data);
          }
        })
        .catch(error => {
          console.error("Erreur réseau :", error);
          alert("Erreur réseau : " + error);
        });
    });
  </script>

</body>
</html>